@startuml

title UC3 - Definir Categoria de Tarefa

actor Administrativo as admnin
participant AreaAdministrativoUI as ui
participant DefinirCategoriaTarefaCtrl as ctrl
participant PlataformaController as platctrl
participant Plataforma as plat
participant RepositorioAreaAtividade as repoarea
participant RepositorioCompetenciatecnica as repocomp
participant RepositorioCategoriaTarefa as repocat
participant CompetenciasTecnicas

activate admin
admin -> ui: 1: Inicia definicao de \n nova categoria de tarefa
activate ui
ui -> platctrl: getAreasAtividade()
ui -> platctrl: getGrausProficiencia()

deactivate RepositorioCategoriaTarefa

group sd loop
    Administrativo -> UI: 3 Seleciona competencia \ntecnica
    activate UI
    UI -> Ctrl: 3.1 lg= getGrausProficiencia\n(codCompetencia)
    activate Ctrl
    Ctrl -> RepositorioCompetenciatecnica: 3.1.1 ct= getCompetenciaTecnica\n(codCompetencia)
    activate RepositorioCompetenciatecnica
    deactivate RepositorioCompetenciatecnica
    Ctrl -> CompetenciasTecnicas: 3.1.2 lg = getGrausProficiencia(ct)
    activate CompetenciasTecnicas
    deactivate CompetenciasTecnicas
    deactivate Ctrl
    UI --> Administrativo: 3.2 Mostra graus de \nproficiencia relativos a \ncompetencia\ntecnica selecionada
    deactivate UI

    Administrativo -> UI: 4 Seleciona grau de\nproficiencia minimo e\nobrigatoriedade da\ncompetencia tecnica
    activate UI
    UI -> Ctrl: 4.1 setProficienciaObrigatoriedade\n(codGrau, obrigatoria)
    activate Ctrl
    Ctrl -> CompetenciasTecnicas: 4.1.1 gp=getGrauProficiencia(codGrau)
    activate CompetenciasTecnicas
    deactivate CompetenciasTecnicas
    Ctrl -> Categoria: 4.1.2 novaCaraterizacao (ct, gp, obrigatoria)
    activate Categoria
    UI --> Administrativo: 4.2 Apresenta dados\n e solicita confirmacao
    deactivate UI
    deactivate Ctrl
    Categoria --> "cct CaracterizacaoCT" **: 4.1.2.1 create(ct, gt, obrigatoria)
    participant "cct CaracterizacaoCT"
    Categoria ->Categoria: 4.1.2.2 addCaracterizacaoCT(ctt)
    deactivate Categoria
end

Administrativo -> UI: 5 Confirma
activate UI
UI -> Ctrl: registaCategoria()
activate Ctrl
UI --> Administrativo: 5.2 Informa operacao\nbem sucedida
deactivate UI
Ctrl -> RepositorioCategoriaTarefa: 5.1.1 registaCategoria(c)
deactivate Ctrl
activate RepositorioCategoriaTarefa
RepositorioCategoriaTarefa -> RepositorioCategoriaTarefa: 5.1.1.1 valida(c)
RepositorioCategoriaTarefa -> RepositorioCategoriaTarefa: 5.1.1.2 addCategoria(c)
deactivate RepositorioCategoriaTarefa

@enduml